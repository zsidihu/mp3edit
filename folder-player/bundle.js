!function(e){!function require(t){var a={exports:{}};return e[t][0].call(a.exports,function(a){return require(e[t][1][a])},a,a.exports),a.exports}(2)}({1:[function(e,t,a){"use strict";const i=["rect","circle","ellipse","line","polyline","polygon","path","text","tspan","textPath","svg","g","defs","use","symbol","style","clipPath","mask","filter","pattern","linearGradient","radialGradient","title","desc","image"],n={$:document.querySelector.bind(document),$$:document.querySelectorAll.bind(document),cE(e,t={}){const a=i.includes(e)?document.createElementNS("http://www.w3.org/2000/svg",e):document.createElement(e);for(const[e,i]of Object.entries(t))null!=i&&a.setAttribute(e,i);return a},addClass(e,...t){const a=e instanceof Element?e:this.$(e);a?.classList.add(...t)},remClass(e,...t){const a=e instanceof Element?e:this.$(e);a?.classList.remove(...t)},addClassAll(e,...t){this.$$(e).forEach(e=>e.classList.add(...t))},remClassAll(e,...t){this.$$(e).forEach(e=>e.classList.remove(...t))},attr(e,t,a){const i=e instanceof Element?e:this.$(e);if(i)return void 0===a?i.getAttribute(t):void i.setAttribute(t,a)},css(e,t,a){const i=e instanceof Element?e:this.$(e);i&&("string"==typeof t&&void 0!==a?i.style[t]=a:"object"==typeof t&&Object.assign(i.style,t))},html(e,t){const a=e instanceof Element?e:this.$(e);if(a)return void 0===t?a.innerHTML:void(a.innerHTML=t)},text(e,t){const a=e instanceof Element?e:this.$(e);if(a)return void 0===t?a.textContent:void(a.textContent=t)},on(e,t,a,i){const n=e instanceof Element||e instanceof Document||e===window?e:this.$(e);n?.addEventListener(t,a,i)},off(e,t,a,i){const n=e instanceof Element||e instanceof Document||e===window?e:this.$(e);n?.removeEventListener(t,a,i)}};class FFmpegHelper{ffmpegCore=null;ffmpegRunning=!1;ffmpegCurrentDuration=null;ffmpegLogContent=null;ffmpegLogEmptyCount=0;ffmpegDurationHandler=null;ffmpegProgressHandler=null;ffmpegLogHandler=null;handleFFmpegOutput=(e,t)=>{null!=this.ffmpegLogHandler&&this.ffmpegLogHandler(e,t),this.detectDuration(t),this.detectProgress(t),this.detectCompletion(t)};initialzeFFmpeg=async()=>{await createFFmpegCore({print:e=>{this.handleFFmpegOutput("stdout",e)},printErr:e=>{this.handleFFmpegOutput("stdout",e)}}).then(async e=>{this.ffmpegCore=e})};inSeconds=e=>3600*parseFloat(e[1])+60*parseFloat(e[2])+parseFloat(e[3])+1e3*parseFloat("0."+e[4])/1e3;detectProgress=e=>{var t=e.match(/.*time.(\d\d).(\d\d).(\d\d).(\d+).*/m);if(null!=t){var a=this.inSeconds(t),i=a;return null!=this.ffmpegCurrentDuration&&(i=~~(a/this.ffmpegCurrentDuration*100)),null!=this.ffmpegProgressHandler&&this.ffmpegProgressHandler(i),a}};FS=()=>this.ffmpegCore.FS;detectDuration=e=>{var t=e.match(/.*Duration..(\d\d).(\d\d).(\d\d).(\d+).*/m);if(null!=t){var a=this.inSeconds(t);return null!=this.ffmpegDurationHandler&&this.ffmpegDurationHandler(a),this.ffmpegCurrentDuration=a,a}};detectCompletion=e=>{(e.includes("kB muxing overhead")||e.includes("Invalid argument")||e.includes("Invalid data found")||e.includes("At least one output file"))&&null!==this.runResolve&&(this.runResolve(),this.runResolve=null,this.ffmpegLogEmptyCount=0,this.ffmpegRunning=!1,this.ffmpegCurrentDuration=null,null!=this.ffmpegProgressHandler&&this.ffmpegProgressHandler(100))};run=e=>{if(e=["-y","-hide_banner","-stats_period","0.2","-loglevel","info","-nostdin",...e],this.ffmpegRunning)throw Error("ffmpeg.wasm can only run one command at a time");return this.ffmpegRunning=!0,new Promise(t=>{this.runResolve=t,this.ffmpegCore.callMain(e)})}}var s,o={getInstance:function(){return s||(s=function createInstance(){var e=new FFmpegHelper;return e.initialzeFFmpeg(),e}()),s}};t.exports={Attach:(e,t)=>{for(let a in t)e.appendChild(t[a])},Elem:n,FFmpegSingleton:o,ScrollController:class ScrollController{constructor(e,t={}){this.container=e,this.ease=t.ease||.1,this.targetScrollTop=this.container.scrollTop,this.currentScrollTop=this.container.scrollTop,this.scrolling=!1,this.onWheel=this.onWheel.bind(this),this.animate=this.animate.bind(this),this.container.addEventListener("wheel",this.onWheel,{passive:!1})}onWheel(e){if(this.isInsideAnotherScrollable(e.target))return;e.preventDefault(),this.targetScrollTop+=e.deltaY;const t=this.container.scrollHeight-this.container.clientHeight;this.targetScrollTop=Math.max(0,Math.min(t,this.targetScrollTop)),this.scrolling||(this.scrolling=!0,requestAnimationFrame(this.animate))}animate(){const e=this.targetScrollTop-this.currentScrollTop;Math.abs(e)>.5?(this.currentScrollTop+=e*this.ease,this.container.scrollTop=this.currentScrollTop,requestAnimationFrame(this.animate)):(this.container.scrollTop=this.targetScrollTop,this.currentScrollTop=this.targetScrollTop,this.scrolling=!1)}isInsideAnotherScrollable(e){let t=e;for(;t&&t!==this.container;){const e=getComputedStyle(t).overflowY;if(("auto"===e||"scroll"===e)&&t.scrollHeight>t.clientHeight)return!0;t=t.parentElement}return!1}},isSuppoted:e=>{if(!e)return!1;const t={mp3:"audio/mpeg",wav:"audio/wav",ogg:'audio/ogg; codecs="vorbis"',aac:'audio/mp4; codecs="mp4a.40.2"',m4a:'audio/mp4; codecs="mp4a.40.2"',flac:"audio/flac",opus:'audio/ogg; codecs="opus"'}[e.split(".").pop().toLowerCase()];if(!t)return!1;const a=document.createElement("audio").canPlayType(t);return"probably"===a||"maybe"===a},TouchDevice:()=>{let e=!1;var t;return t=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0),e}}},{}],2:[function(e,t,a){"use strict";const{Attach:i,Elem:n,FFmpegSingleton:s,ScrollController:o,isSuppoted:r,TouchDevice:c}=e("./a.js"),openDB=async()=>new Promise(e=>{const t=indexedDB.open("player-handles",1);t.onupgradeneeded=e=>e.target.result.createObjectStore("dirs"),t.onsuccess=()=>e(t.result)}),l=new(window.AudioContext||window.webkitAudioContext),d=n.$("#tracks"),m=n.$("#album-artist"),u=n.$("#album-title"),h=n.$("#track-title"),p=n.$("#cover"),f=n.$("audio"),w=n.$("canvas"),g=w.getContext("2d");let v=null,b=null,y=0,k=null,x=!1;const F={repeat:!1,shuffle:!1},q=l.createMediaElementSource(f),z=l.createAnalyser(),M={light:n.$("#theme-light"),dark:n.$("#theme-dark"),used:"theme-dark"},S=Array.from(document.querySelectorAll('input[type="range"]')),E=[60,170,310,600,1e3,3e3].map(e=>{const t=l.createBiquadFilter();return t.type="peaking",t.Q.value=1.2,t.gain.value=0,t.frequency.value=e,t});S.forEach((e,t)=>{e.addEventListener("input",e=>{const a=parseFloat(e.target.value);E[t].gain.value=a,(()=>{const e=E.map(e=>e.gain.value);localStorage.setItem("eqGains",JSON.stringify(e))})()})});const UpdateHeight=()=>{const e=window.innerHeight+"px";document.documentElement.style.height=e,document.body.style.height=e};let A=null,C=null,D=[];const drawBarLight=(e,t,a,i,n,s,o,r)=>{const c=(360*o/r+.002*performance.now())%360,l=g.createLinearGradient(e,t,a,i);l.addColorStop(0,`hsl(${c}, 80%, 45%)`),l.addColorStop(.5,`hsl(${(c+40)%360}, 80%, 50%)`),l.addColorStop(1,`hsl(${(c+80)%360}, 80%, 55%)`),g.strokeStyle=l,g.lineWidth=n,g.beginPath(),g.moveTo(e,t),g.lineTo(a,i),g.stroke()},drawBarDark=(e,t,a,i,n,s,o,r)=>{let c=g.createLinearGradient(0,0,0,w.height);c.addColorStop(0,"#37FF8B"),c.addColorStop(1,"#51D6FF"),g.strokeStyle=c,g.lineWidth=n,g.beginPath(),g.moveTo(e,t),g.lineTo(a,i),g.stroke()},visualizer=()=>{const e=w.width/2,t=w.height/2;g.clearRect(0,0,w.width,w.height),z.getByteFrequencyData(C);const a=120;for(let i=0;i<a;i++){const n=2*Math.PI/a,s=.15*C[i],o=e+60*Math.cos(n*i),r=t+60*Math.sin(n*i),c=e+Math.cos(n*i)*(60+s),l=t+Math.sin(n*i)*(60+s);"theme-light"==M.used?drawBarLight(o,r,c,l,3,C[i],i,a):drawBarDark(o,r,c,l,3,C[i])}x&&requestAnimationFrame(visualizer)},toggleMenu=e=>{const t=n.$("#open-menu");"auto"===e&&(t.classList.toggle("opened"),t.setAttribute("aria-expanded",t.classList.contains("opened"))),"close"===e&&(n.remClass(t,"opened"),t.setAttribute("aria-expanded",!1)),t.classList.contains("opened")?n.addClass("section","visible"):n.remClass("section","visible")},scanAndShow=async(e,t="name")=>{d.replaceChildren(),D=[];for await(const t of e.values())if("file"===t.kind&&/\.(mp3|m4a|flac|alac|ogg|opus|wav|wma|wv)$/i.test(t.name)){const e=await t.getFile();D.push({entry:t,file:e})}switch(t){case"name":D.sort((e,t)=>e.file.name.localeCompare(t.file.name));break;case"date":D.sort((e,t)=>t.file.lastModified-e.file.lastModified);break;case"size":D.sort((e,t)=>e.file.size-t.file.size)}for(const[e,{entry:t,file:a}]of D.entries()){const i=a.name.replace(/\.[^.]+$/,""),s=n.cE("div",{class:"track","data-index":e,"data-text":i});s.addEventListener("click",async i=>{b&&n.remClass(b,"active"),n.addClass(s,"active"),n.addClass(s,"loader"),b=s,y=e,await playFile(a,t.name)}),d.appendChild(s)}b&&n.remClass(b,"active"),b=null,y=0,v=new o(d,{ease:.05}),f.pause(),f.currentTime=0,setTimeout(()=>g.clearRect(0,0,w.width,w.height),100)},playNext=async()=>{if(y<D.length-1||F.shuffle){F.repeat||(F.shuffle?y=Math.floor(Math.random()*D.length):++y);const{entry:e,file:t}=D[y],a=n.$('[data-index="'+y+'"]');b&&n.remClass(b,"active"),n.addClass(a,"active"),n.addClass(a,"loader"),b=a,await playFile(t,e.name)}else b&&n.remClass(b,"active"),b=null,y=0,f.pause(),f.currentTime=0,setTimeout(()=>g.clearRect(0,0,w.width,w.height),100)},playFile=async(e,t)=>{const a=e.urn||e.name,i=n.$('[data-index="'+y+'"]');if(ID3.loadTags(a,function(){const e=ID3.getAllTags(a);if(m.textContent=e.artist?e.artist:"",u.textContent=e.album?e.album:"",h.textContent=e.title?e.title:t.replace(/\.[^.]+$/,""),e.picture){let t="";for(var i=0;i<e.picture.data.length;i++)t+=String.fromCharCode(e.picture.data[i]);p.src="data:"+e.picture.format+";base64,"+window.btoa(t)}else p.src="../assets/images/cover.png"},{tags:["title","artist","album","picture"],dataReader:ID3.FileAPIReader(e)}),r(t)){f.onended=async()=>{x=!1,await playNext()},f.src=URL.createObjectURL(e),x=!0,q.connect(z),z.connect(E[0]);for(let e=0;e<E.length-1;e++)E[e].connect(E[e+1]);E[E.length-1].connect(l.destination),A=z.frequencyBinCount,C=new Uint8Array(A),"suspended"===l.state&&await l.resume(),n.remClass(i,"loader"),w.width=240,w.height=240,visualizer(),f.play()}else try{const t=await e.arrayBuffer(),a=s.getInstance();await a.initialzeFFmpeg();const o=["-i",e.name,"-vn","-codec:a","pcm_s16le","-f","wav","output.wav"];a.FS().writeFile(e.name,new Uint8Array(t)),await a.run(o);const r=a.FS().readFile("output.wav"),c=new Blob([r],{type:"audio/wav"});f.onended=async()=>{x=!1,await playNext()},f.src=URL.createObjectURL(c),x=!0,q.connect(z),z.connect(E[0]);for(let e=0;e<E.length-1;e++)E[e].connect(E[e+1]);E[E.length-1].connect(l.destination),A=z.frequencyBinCount,C=new Uint8Array(A),"suspended"===l.state&&await l.resume(),n.remClass(i,"loader"),w.width=240,w.height=240,visualizer(),f.play()}catch(e){}};document.querySelectorAll("a").forEach(async e=>{e.addEventListener("click",async e=>{switch(e.target.id&&e.preventDefault(),e.target.id){case"open-menu":toggleMenu("auto");break;case"clear-playlist":try{const e=(await openDB()).transaction("dirs","readwrite");e.objectStore("dirs").delete("playlist"),await new Promise(t=>e.oncomplete=t),b&&n.remClass(b,"active"),b=null,y=0,f.pause(),f.removeAttribute("src"),f.load(),setTimeout(()=>g.clearRect(0,0,w.width,w.height),100),d.replaceChildren(),D=null}catch(e){}break;case"theme-light":case"theme-dark":Object.values(M).forEach(t=>{t===e.target?n.addClass(t,"active"):n.remClass(t,"active")}),document.documentElement.setAttribute("data-theme",e.target.id),M.used=e.target.id,localStorage.setItem("theme",e.target.id);break;case"about-player":toggleMenu("close"),n.addClass(".version","visible");break;case"open-equalizer":toggleMenu("close"),n.addClass(".equalizer","visible");break;case"reset-equalizer":E.forEach((e,t)=>{e.gain.value=0,S[t].value=0}),localStorage.removeItem("eqGains");break;case"pick-folder":try{const e=await window.showDirectoryPicker(),t=(await openDB()).transaction("dirs","readwrite");t.objectStore("dirs").put(e,"playlist"),await new Promise(e=>t.oncomplete=e),await scanAndShow(e)}catch(e){}break;case"play-prev":x&&await(async()=>{if(!F.repeat)if(y>0){const{entry:e,file:t}=D[--y],a=n.$('[data-index="'+y+'"]');b&&n.remClass(b,"active"),n.addClass(a,"active"),n.addClass(a,"loader"),b=a,await playFile(t,e.name)}else b&&n.remClass(b,"active"),b=null,y=0,f.pause(),f.currentTime=0,setTimeout(()=>g.clearRect(0,0,w.width,w.height),100)})();break;case"play-repeat":e.target.classList.toggle("active"),F.repeat=!!e.target.classList.contains("active");break;case"play-shuffle":e.target.classList.toggle("active"),F.shuffle=!!e.target.classList.contains("active");break;case"play-next":x&&await playNext()}})}),document.addEventListener("click",e=>{const t=e.target.getAttribute("aria-label")??null;"Main Menu"!==t&&"Menu Item"!==t&&toggleMenu("close"),"About Box"!==t&&"Main Menu"!==t&&"Menu Item"!==t&&n.remClass(".version","visible"),"Equalizer Box"!==t&&"Equalizer Range"!==t&&"Main Menu"!==t&&"Menu Item"!==t&&n.remClass(".equalizer","visible")}),window.addEventListener("resize",UpdateHeight),async function(){if(UpdateHeight(),(()=>{const e=localStorage.getItem("eqGains");if(!e)return;JSON.parse(e).forEach((e,t)=>{E[t].gain.value=e,S[t].value=e})})(),!("showDirectoryPicker"in window)){const e=n.$(".confirm"),t=n.cE("p",{"data-text":"Not support directory access."}),a=n.cE("a",{href:"#","data-text":"Ok"}),i=n.cE("div");return e.replaceChildren(),a.addEventListener("click",e=>{e.preventDefault(),n.remClass(".confirm","visible")}),i.appendChild(a),e.appendChild(t),e.appendChild(i),void n.addClass(".confirm","visible")}"theme-light"===(localStorage.getItem("theme")??null)&&(n.addClass(M.light,"active"),n.remClass(M.dark,"active"),M.used="theme-light",document.documentElement.setAttribute("data-theme","theme-light"));const e=(await openDB()).transaction("dirs","readonly").objectStore("dirs").get("playlist");if(k=await new Promise(t=>{e.onsuccess=()=>t(e.result)}),k)try{if("granted"===await k.queryPermission({mode:"read"}))await scanAndShow(k);else{const e=n.$(".confirm"),t=n.cE("p",{"data-text":"Allow access to your files?"}),a=n.cE("a",{href:"#","data-text":"Allow"}),i=n.cE("a",{href:"#","data-text":"Cancel"}),s=n.cE("div");e.replaceChildren(),a.addEventListener("click",async e=>{e.preventDefault();try{"granted"===await k.requestPermission({mode:"read"})?await scanAndShow(k):alert("EngedÃ©ly megtagadva"),n.remClass(".confirm","visible")}catch(e){console.error(e)}}),i.addEventListener("click",e=>{e.preventDefault(),n.remClass(".confirm","visible")}),s.appendChild(a),s.appendChild(i),e.appendChild(t),e.appendChild(s),n.addClass(".confirm","visible")}}catch(e){console.error(e)}}()},{"./a.js":1,"./b.js":2}]});