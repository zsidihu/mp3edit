const audioContext=new(window.AudioContext||window.webkitAudioContext);!function(t){!function require(e){var n={exports:{}};return t[e][0].call(n.exports,function(n){return require(t[e][1][n])},n,n.exports),n.exports}(2)}({1:[function(t,e,n){"use strict";const i=["rect","circle","ellipse","line","polyline","polygon","path","text","tspan","textPath","svg","g","defs","use","symbol","style","clipPath","mask","filter","pattern","linearGradient","radialGradient","title","desc","image"],o={$:document.querySelector.bind(document),$$:document.querySelectorAll.bind(document),cE(t,e={}){const n=i.includes(t)?document.createElementNS("http://www.w3.org/2000/svg",t):document.createElement(t);for(const[t,i]of Object.entries(e))null!=i&&n.setAttribute(t,i);return n},addClass(t,...e){const n=t instanceof Element?t:this.$(t);n?.classList.add(...e)},remClass(t,...e){const n=t instanceof Element?t:this.$(t);n?.classList.remove(...e)},addClassAll(t,...e){this.$$(t).forEach(t=>t.classList.add(...e))},remClassAll(t,...e){this.$$(t).forEach(t=>t.classList.remove(...e))},attr(t,e,n){const i=t instanceof Element?t:this.$(t);if(i)return void 0===n?i.getAttribute(e):void i.setAttribute(e,n)},css(t,e,n){const i=t instanceof Element?t:this.$(t);i&&("string"==typeof e&&void 0!==n?i.style[e]=n:"object"==typeof e&&Object.assign(i.style,e))},html(t,e){const n=t instanceof Element?t:this.$(t);if(n)return void 0===e?n.innerHTML:void(n.innerHTML=e)},text(t,e){const n=t instanceof Element?t:this.$(t);if(n)return void 0===e?n.textContent:void(n.textContent=e)},on(t,e,n,i){const o=t instanceof Element||t instanceof Document||t===window?t:this.$(t);o?.addEventListener(e,n,i)},off(t,e,n,i){const o=t instanceof Element||t instanceof Document||t===window?t:this.$(t);o?.removeEventListener(e,n,i)}};class FFmpegHelper{ffmpegCore=null;ffmpegRunning=!1;ffmpegCurrentDuration=null;ffmpegLogContent=null;ffmpegLogEmptyCount=0;ffmpegDurationHandler=null;ffmpegProgressHandler=null;ffmpegLogHandler=null;handleFFmpegOutput=(t,e)=>{null!=this.ffmpegLogHandler&&this.ffmpegLogHandler(t,e),this.detectDuration(e),this.detectProgress(e),this.detectCompletion(e)};initialzeFFmpeg=async()=>{await createFFmpegCore({print:t=>{this.handleFFmpegOutput("stdout",t)},printErr:t=>{this.handleFFmpegOutput("stdout",t)}}).then(async t=>{this.ffmpegCore=t})};inSeconds=t=>3600*parseFloat(t[1])+60*parseFloat(t[2])+parseFloat(t[3])+1e3*parseFloat("0."+t[4])/1e3;detectProgress=t=>{var e=t.match(/.*time.(\d\d).(\d\d).(\d\d).(\d+).*/m);if(null!=e){var n=this.inSeconds(e),i=n;return null!=this.ffmpegCurrentDuration&&(i=~~(n/this.ffmpegCurrentDuration*100)),null!=this.ffmpegProgressHandler&&this.ffmpegProgressHandler(i),n}};FS=()=>this.ffmpegCore.FS;detectDuration=t=>{var e=t.match(/.*Duration..(\d\d).(\d\d).(\d\d).(\d+).*/m);if(null!=e){var n=this.inSeconds(e);return null!=this.ffmpegDurationHandler&&this.ffmpegDurationHandler(n),this.ffmpegCurrentDuration=n,n}};detectCompletion=t=>{(t.includes("kB muxing overhead")||t.includes("Invalid argument")||t.includes("Invalid data found")||t.includes("At least one output file"))&&null!==this.runResolve&&(this.runResolve(),this.runResolve=null,this.ffmpegLogEmptyCount=0,this.ffmpegRunning=!1,this.ffmpegCurrentDuration=null,null!=this.ffmpegProgressHandler&&this.ffmpegProgressHandler(100))};run=t=>{if(t=["-y","-hide_banner","-stats_period","0.2","-loglevel","info","-nostdin",...t],this.ffmpegRunning)throw Error("ffmpeg.wasm can only run one command at a time");return this.ffmpegRunning=!0,new Promise(e=>{this.runResolve=e,this.ffmpegCore.callMain(t)})}}var a,s={getInstance:function(){return a||(a=function createInstance(){var t=new FFmpegHelper;return t.initialzeFFmpeg(),t}()),a}};e.exports={AudioBufferToPCM:t=>new Promise(e=>{const n=t.numberOfChannels,i=t.length,o=t.sampleRate,a=new Int16Array(i*n);let s=0;const processChunk=()=>{const r=Math.min(s+16384,i);for(;s<r;s++)for(let e=0;e<n;e++){let i=t.getChannelData(e)[s];i=Math.max(-1,Math.min(1,i)),a[s*n+e]=i<0?32768*i:32767*i}s<i?setTimeout(processChunk,0):e({audioData:new Uint8Array(a.buffer),sampleRate:o,numberOfChannels:n})};processChunk()}),Attach:(t,e)=>{for(let n in e)t.appendChild(e[n])},Elem:o,FFmpegSingleton:s,isSuppoted:t=>{if(!t)return!1;const e={mp3:"audio/mpeg",wav:"audio/wav",ogg:'audio/ogg; codecs="vorbis"',aac:'audio/mp4; codecs="mp4a.40.2"',m4a:'audio/mp4; codecs="mp4a.40.2"',flac:"audio/flac",opus:'audio/ogg; codecs="opus"'}[t.split(".").pop().toLowerCase()];if(!e)return!1;const n=document.createElement("audio").canPlayType(e);return"probably"===n||"maybe"===n},SleepMS:t=>new Promise(e=>setTimeout(e,t)),TouchDevice:()=>{let t=!1;var e;return e=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0),t}}},{}],2:[function(t,e,n){"use strict";const{AudioBufferToPCM:i,Attach:o,Elem:a,FFmpegSingleton:s,isSuppoted:r,SleepMS:c,TouchDevice:l}=t("./a.js"),toggleMenu=t=>{const e=a.$("#open-menu");"auto"===t&&(e.classList.toggle("opened"),e.setAttribute("aria-expanded",e.classList.contains("opened"))),"close"===t&&(a.remClass(e,"opened"),e.setAttribute("aria-expanded",!1)),e.classList.contains("opened")?a.addClass("section","visible"):a.remClass("section","visible")};a.on(document,"click",async t=>{const e=t.target.getAttribute("aria-label")??null;if("Main Menu"!==e&&"Menu Item"!==e&&toggleMenu("close"),t.target.hasAttribute("data-button")){t.preventDefault();const e=t.target,n=e.dataset.button;if("openMenu"===n)toggleMenu("auto");else if("openFile"===n){const t=a.cE("input",{type:"file"}),fname=(t,e)=>{const n=t.lastIndexOf(".");return n<=0?t+e:t.slice(0,n)+e},toB64=(t,e)=>{const n=new FileReader;n.onloadend=()=>e(n.result),n.readAsDataURL(t)};a.on(t,"input",async t=>{const n=t.target.files[0];if(n){a.addClass(e,"disabled");let t=null;if(r(n.name))t=await audioContext.decodeAudioData(await n.arrayBuffer());else try{const e=await n.arrayBuffer(),i=s.getInstance();await i.initialzeFFmpeg();const o=["-i",n.name,"-vn","-codec:a","pcm_s16le","-f","wav","output.wav"];i.FS().writeFile(n.name,new Uint8Array(e)),await i.run(o);const a=i.FS().readFile("output.wav");t=await audioContext.decodeAudioData(a.buffer.slice(a.byteOffset,a.byteOffset+a.byteLength))}catch(t){return void a.remClass(e,"disabled")}if(t){t=function trimSilence(t,e=1,n=.01){const i=[],o=t.sampleRate,a=t.numberOfChannels;for(let e=0;e<a;e++)i.push(t.getChannelData(e));const s=function autoThreshold(t,e=.01){let n=0;for(let e=0;e<t.length;e++)Math.abs(t[e])>n&&(n=Math.abs(t[e]));return n*e}(i[0],n);function findStart(t){for(let e=0;e<t.length;e++)if(Math.abs(t[e])>s)return e;return t.length}function findEnd(t){for(let e=t.length-1;e>=0;e--)if(Math.abs(t[e])>s)return e;return 0}let r=0,c=i[0].length-1;if(1===e)r=findStart(i[0]);else if(2===e)c=findEnd(i[0]);else if(3===e)r=findStart(i[0]),c=findEnd(i[0]);else if(4===e){const t=[];let e=!1,n=0;for(let o=0;o<i[0].length;o++){const a=Math.abs(i[0][o])<=s;a||e?a&&e&&(t.push([n,o]),e=!1):(n=o,e=!0)}e&&t.push([n,i[0].length]);const r=t.reduce((t,[e,n])=>t+(n-e),0),c=new AudioBuffer({length:r,sampleRate:o,numberOfChannels:a});for(let e=0;e<a;e++){const n=c.getChannelData(e);let o=0;t.forEach(([t,a])=>{n.set(i[e].subarray(t,a),o),o+=a-t})}return c}const l=new AudioBuffer({length:c-r+1,sampleRate:o,numberOfChannels:a});for(let t=0;t<a;t++)l.getChannelData(t).set(i[t].subarray(r,c+1));return l}(t,d.mode,d.factor);const o=await i(t),r=s.getInstance();let c,l,u;switch(await r.initialzeFFmpeg(),r.FS().writeFile("input.pcm",o.audioData),d.output){case"mp3":u=fname("trimmed_"+n.name,".mp3"),l="audio/mpeg",c=["-f","s16le","-ar",o.sampleRate.toString(),"-ac",o.numberOfChannels.toString(),"-i","input.pcm","-vn","-c:a","libmp3lame",u];break;case"wav":u=fname("trimmed_"+n.name,".wav"),l="audio/wav",c=["-f","s16le","-ar",o.sampleRate.toString(),"-ac",o.numberOfChannels.toString(),"-i","input.pcm","-vn","-c:a","pcm_s16le",u];break;case"ogg":u=fname("trimmed_"+n.name,".ogg"),l="audio/ogg",c=["-f","s16le","-ar",o.sampleRate.toString(),"-ac",o.numberOfChannels.toString(),"-i","input.pcm","-vn","-c:a","libopus",u]}try{await r.run(c)}catch(t){return void a.remClass(e,"disabled")}const m=r.FS().readFile(u),p=new Blob([m.buffer],{type:l});toB64(p,t=>{const e=a.cE("a",{download:u,href:t});document.body.appendChild(e),e.click(),document.body.removeChild(e)}),t=null}a.remClass(e,"disabled")}}),t.click()}}});const d={mode:3,factor:.005,output:"wav"};a.on(document,"input",t=>{const e=t.target,n=e.nextElementSibling,i=e.value,o=e.id;switch(o){case"mode":d[o]=parseFloat(i);break;case"factor":d[o]=parseFloat(i),n.textContent="Threshold factor: "+d[o].toFixed(3);break;case"type-ogg":case"type-mp3":case"type-wav":d.output=i}})},{"./a.js":1,"./b.js":2}]});